var Ee=Object.defineProperty;var We=(e,t,n)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var f=(e,t,n)=>We(e,typeof t!="symbol"?t+"":t,n);import{H as A,J as h,ai as Pe,Q as S,aj as Ve,a7 as I,b as r,s as T,N as de,bP as Fe,c1 as Ue,Y as He,Z as Ke,a0 as ve,aO as qe,v as R,a4 as Ge,z as Z,c2 as Je,c3 as Ye,ab as $e,A as Ze,i as te,h as we,F as ne,m as Ae,x as Qe,bo as Xe,a_ as j,aZ as M,I as Be,bp as me,bz as pe,O as F,P as Te,az as _e,U as De,X as xe,aD as Re,bq as Ne,bB as et,bb as ae,a8 as W,aH as Me,a6 as tt,aV as nt,M as at,c4 as rt,ax as st,ay as it,by as ot,bA as ct,_ as lt,c5 as ut,c6 as dt,aC as vt,bC as mt,c7 as ft}from"./index-CdBy1DAC.js";function gt(e){return{aspectStyles:T(()=>{const t=Number(e.aspectRatio);return t?{paddingBottom:String(1/t*100)+"%"}:void 0})}}const Oe=A({aspectRatio:[String,Number],contentClass:null,inline:Boolean,...h(),...Pe()},"VResponsive"),ye=S()({name:"VResponsive",props:Oe(),setup(e,t){let{slots:n}=t;const{aspectStyles:a}=gt(e),{dimensionStyles:s}=Ve(e);return I(()=>{var i;return r("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[s.value,e.style]},[r("div",{class:"v-responsive__sizer",style:a.value},null),(i=n.additional)==null?void 0:i.call(n),n.default&&r("div",{class:["v-responsive__content",e.contentClass]},[n.default()])])}),{}}}),yt=A({absolute:Boolean,alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...Oe(),...h(),...de(),...Fe()},"VImg"),Le=S()({name:"VImg",directives:{intersect:Ue},props:yt(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,t){let{emit:n,slots:a}=t;const{backgroundColorClasses:s,backgroundColorStyles:i}=He(Ke(e,"color")),{roundedClasses:l}=ve(e),v=qe("VImg"),u=R(""),c=Ge(),d=R(e.eager?"loading":"idle"),y=R(),B=R(),g=T(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),C=T(()=>g.value.aspect||y.value/B.value||0);Z(()=>e.src,()=>{D(d.value!=="idle")}),Z(C,(o,m)=>{!o&&m&&c.value&&V(c.value)}),Je(()=>D());function D(o){if(!(e.eager&&o)&&!(Ye&&!o&&!e.eager)){if(d.value="loading",g.value.lazySrc){const m=new Image;m.src=g.value.lazySrc,V(m,null)}g.value.src&&$e(()=>{var m;n("loadstart",((m=c.value)==null?void 0:m.currentSrc)||g.value.src),setTimeout(()=>{var b;if(!v.isUnmounted)if((b=c.value)!=null&&b.complete){if(c.value.naturalWidth||O(),d.value==="error")return;C.value||V(c.value,null),d.value==="loading"&&k()}else C.value||V(c.value),P()})})}}function k(){var o;v.isUnmounted||(P(),V(c.value),d.value="loaded",n("load",((o=c.value)==null?void 0:o.currentSrc)||g.value.src))}function O(){var o;v.isUnmounted||(d.value="error",n("error",((o=c.value)==null?void 0:o.currentSrc)||g.value.src))}function P(){const o=c.value;o&&(u.value=o.currentSrc||o.src)}let x=-1;Ze(()=>{clearTimeout(x)});function V(o){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const b=()=>{if(clearTimeout(x),v.isUnmounted)return;const{naturalHeight:fe,naturalWidth:ge}=o;fe||ge?(y.value=ge,B.value=fe):!o.complete&&d.value==="loading"&&m!=null?x=window.setTimeout(b,m):(o.currentSrc.endsWith(".svg")||o.currentSrc.startsWith("data:image/svg+xml"))&&(y.value=1,B.value=1)};b()}const L=T(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),q=()=>{var b;if(!g.value.src||d.value==="idle")return null;const o=r("img",{class:["v-img__img",L.value],style:{objectPosition:e.position},src:g.value.src,srcset:g.value.srcset,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable,sizes:e.sizes,ref:c,onLoad:k,onError:O},null),m=(b=a.sources)==null?void 0:b.call(a);return r(j,{transition:e.transition,appear:!0},{default:()=>[te(m?r("picture",{class:"v-img__picture"},[m,o]):o,[[Xe,d.value==="loaded"]])]})},G=()=>r(j,{transition:e.transition},{default:()=>[g.value.lazySrc&&d.value!=="loaded"&&r("img",{class:["v-img__img","v-img__img--preload",L.value],style:{objectPosition:e.position},src:g.value.lazySrc,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable},null)]}),J=()=>a.placeholder?r(j,{transition:e.transition,appear:!0},{default:()=>[(d.value==="loading"||d.value==="error"&&!a.error)&&r("div",{class:"v-img__placeholder"},[a.placeholder()])]}):null,Y=()=>a.error?r(j,{transition:e.transition,appear:!0},{default:()=>[d.value==="error"&&r("div",{class:"v-img__error"},[a.error()])]}):null,$=()=>e.gradient?r("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,z=R(!1);{const o=Z(C,m=>{m&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{z.value=!0})}),o())})}return I(()=>{const o=ye.filterProps(e);return te(r(ye,Ae({class:["v-img",{"v-img--absolute":e.absolute,"v-img--booting":!z.value},s.value,l.value,e.class],style:[{width:Qe(e.width==="auto"?y.value:e.width)},i.value,e.style]},o,{aspectRatio:C.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>r(ne,null,[r(q,null,null),r(G,null,null),r($,null,null),r(J,null,null),r(Y,null,null)]),default:a.default}),[[we("intersect"),{handler:D,options:e.options},null,{once:!0}]])}),{currentSrc:u,image:c,state:d,naturalWidth:y,naturalHeight:B}}}),bt=A({start:Boolean,end:Boolean,icon:M,image:String,text:String,...Be(),...h(),...me(),...de(),...pe(),...F(),...Te(),..._e({variant:"flat"})},"VAvatar"),be=S()({name:"VAvatar",props:bt(),setup(e,t){let{slots:n}=t;const{themeClasses:a}=De(e),{borderClasses:s}=xe(e),{colorClasses:i,colorStyles:l,variantClasses:v}=Re(e),{densityClasses:u}=Ne(e),{roundedClasses:c}=ve(e),{sizeClasses:d,sizeStyles:y}=et(e);return I(()=>r(e.tag,{class:["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},a.value,s.value,i.value,u.value,c.value,d.value,v.value,e.class],style:[l.value,y.value,e.style]},{default:()=>[n.default?r(W,{key:"content-defaults",defaults:{VImg:{cover:!0,src:e.image},VIcon:{icon:e.icon}}},{default:()=>[n.default()]}):e.image?r(Le,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?r(ae,{key:"icon",icon:e.icon},null):e.text,Me(!1,"v-avatar")]})),{}}}),ht=S()({name:"VCardActions",props:h(),setup(e,t){let{slots:n}=t;return tt({VBtn:{slim:!0,variant:"text"}}),I(()=>{var a;return r("div",{class:["v-card-actions",e.class],style:e.style},[(a=n.default)==null?void 0:a.call(n)])}),{}}}),St=A({opacity:[Number,String],...h(),...F()},"VCardSubtitle"),It=S()({name:"VCardSubtitle",props:St(),setup(e,t){let{slots:n}=t;return I(()=>r(e.tag,{class:["v-card-subtitle",e.class],style:[{"--v-card-subtitle-opacity":e.opacity},e.style]},n)),{}}}),Ct=nt("v-card-title"),kt=A({appendAvatar:String,appendIcon:M,prependAvatar:String,prependIcon:M,subtitle:[String,Number],title:[String,Number],...h(),...me()},"VCardItem"),Pt=S()({name:"VCardItem",props:kt(),setup(e,t){let{slots:n}=t;return I(()=>{var c;const a=!!(e.prependAvatar||e.prependIcon),s=!!(a||n.prepend),i=!!(e.appendAvatar||e.appendIcon),l=!!(i||n.append),v=!!(e.title!=null||n.title),u=!!(e.subtitle!=null||n.subtitle);return r("div",{class:["v-card-item",e.class],style:e.style},[s&&r("div",{key:"prepend",class:"v-card-item__prepend"},[n.prepend?r(W,{key:"prepend-defaults",disabled:!a,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},n.prepend):r(ne,null,[e.prependAvatar&&r(be,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&r(ae,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),r("div",{class:"v-card-item__content"},[v&&r(Ct,{key:"title"},{default:()=>{var d;return[((d=n.title)==null?void 0:d.call(n))??e.title]}}),u&&r(It,{key:"subtitle"},{default:()=>{var d;return[((d=n.subtitle)==null?void 0:d.call(n))??e.subtitle]}}),(c=n.default)==null?void 0:c.call(n)]),l&&r("div",{key:"append",class:"v-card-item__append"},[n.append?r(W,{key:"append-defaults",disabled:!i,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},n.append):r(ne,null,[e.appendIcon&&r(ae,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&r(be,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),Vt=A({opacity:[Number,String],...h(),...F()},"VCardText"),wt=S()({name:"VCardText",props:Vt(),setup(e,t){let{slots:n}=t;return I(()=>r(e.tag,{class:["v-card-text",e.class],style:[{"--v-card-text-opacity":e.opacity},e.style]},n)),{}}}),At=A({appendAvatar:String,appendIcon:M,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:M,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number],text:[String,Number],title:[String,Number],...Be(),...h(),...me(),...Pe(),...at(),...rt(),...st(),...it(),...de(),...ot(),...F(),...Te(),..._e({variant:"elevated"})},"VCard"),Yt=S()({name:"VCard",directives:{Ripple:ct},props:At(),setup(e,t){let{attrs:n,slots:a}=t;const{themeClasses:s}=De(e),{borderClasses:i}=xe(e),{colorClasses:l,colorStyles:v,variantClasses:u}=Re(e),{densityClasses:c}=Ne(e),{dimensionStyles:d}=Ve(e),{elevationClasses:y}=lt(e),{loaderClasses:B}=ut(e),{locationStyles:g}=dt(e),{positionClasses:C}=vt(e),{roundedClasses:D}=ve(e),k=mt(e,n),O=T(()=>e.link!==!1&&k.isLink.value),P=T(()=>!e.disabled&&e.link!==!1&&(e.link||k.isClickable.value));return I(()=>{const x=O.value?"a":e.tag,V=!!(a.title||e.title!=null),L=!!(a.subtitle||e.subtitle!=null),q=V||L,G=!!(a.append||e.appendAvatar||e.appendIcon),J=!!(a.prepend||e.prependAvatar||e.prependIcon),Y=!!(a.image||e.image),$=q||J||G,z=!!(a.text||e.text!=null);return te(r(x,Ae({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":P.value},s.value,i.value,l.value,c.value,y.value,B.value,C.value,D.value,u.value,e.class],style:[v.value,d.value,g.value,e.style],onClick:P.value&&k.navigate,tabindex:e.disabled?-1:void 0},k.linkProps),{default:()=>{var o;return[Y&&r("div",{key:"image",class:"v-card__image"},[a.image?r(W,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},a.image):r(Le,{key:"image-img",cover:!0,src:e.image},null)]),r(ft,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:a.loader}),$&&r(Pt,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:a.item,prepend:a.prepend,title:a.title,subtitle:a.subtitle,append:a.append}),z&&r(wt,{key:"text"},{default:()=>{var m;return[((m=a.text)==null?void 0:m.call(a))??e.text]}}),(o=a.default)==null?void 0:o.call(a),a.actions&&r(ht,null,{default:a.actions}),Me(P.value,"v-card")]}}),[[we("ripple"),P.value&&e.ripple]])}),{}}});class E{constructor(t,n,a,s,i,l,v,u){f(this,"id");f(this,"recordType");f(this,"dateTime");f(this,"amount");f(this,"categoryId");f(this,"accountId");f(this,"memo");f(this,"fee");f(this,"toAccountId");this.recordType=t,this.dateTime=n,this.amount=a,this.categoryId=s,this.accountId=i,this.memo=l,this.fee=v,this.toAccountId=u}static getNewSpendRecord(t,n){return new E("支出",new Date,0,t,n)}static getNewIncomeRecord(t,n){return new E("收入",new Date,0,t,n)}static getNewTransferRecord(t,n){return new E("轉移",new Date,0,void 0,t,void 0,void 0,n)}}var N=(e=>(e.Spend="支出",e.Income="收入",e.Transfer="轉移",e))(N||{});const re=(e,t)=>t.some(n=>e instanceof n);let he,Se;function Bt(){return he||(he=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Tt(){return Se||(Se=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const se=new WeakMap,Q=new WeakMap,U=new WeakMap;function _t(e){const t=new Promise((n,a)=>{const s=()=>{e.removeEventListener("success",i),e.removeEventListener("error",l)},i=()=>{n(w(e.result)),s()},l=()=>{a(e.error),s()};e.addEventListener("success",i),e.addEventListener("error",l)});return U.set(t,e),t}function Dt(e){if(se.has(e))return;const t=new Promise((n,a)=>{const s=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",l),e.removeEventListener("abort",l)},i=()=>{n(),s()},l=()=>{a(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",i),e.addEventListener("error",l),e.addEventListener("abort",l)});se.set(e,t)}let ie={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return se.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return w(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function ze(e){ie=e(ie)}function xt(e){return Tt().includes(e)?function(...t){return e.apply(oe(this),t),w(this.request)}:function(...t){return w(e.apply(oe(this),t))}}function Rt(e){return typeof e=="function"?xt(e):(e instanceof IDBTransaction&&Dt(e),re(e,Bt())?new Proxy(e,ie):e)}function w(e){if(e instanceof IDBRequest)return _t(e);if(Q.has(e))return Q.get(e);const t=Rt(e);return t!==e&&(Q.set(e,t),U.set(t,e)),t}const oe=e=>U.get(e);function Nt(e,t,{blocked:n,upgrade:a,blocking:s,terminated:i}={}){const l=indexedDB.open(e,t),v=w(l);return a&&l.addEventListener("upgradeneeded",u=>{a(w(l.result),u.oldVersion,u.newVersion,w(l.transaction),u)}),n&&l.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),v.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),v}const Mt=["get","getKey","getAll","getAllKeys","count"],Ot=["put","add","delete","clear"],X=new Map;function Ie(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(X.get(t))return X.get(t);const n=t.replace(/FromIndex$/,""),a=t!==n,s=Ot.includes(n);if(!(n in(a?IDBIndex:IDBObjectStore).prototype)||!(s||Mt.includes(n)))return;const i=async function(l,...v){const u=this.transaction(l,s?"readwrite":"readonly");let c=u.store;return a&&(c=c.index(v.shift())),(await Promise.all([c[n](...v),s&&u.done]))[0]};return X.set(t,i),i}ze(e=>({...e,get:(t,n,a)=>Ie(t,n)||e.get(t,n,a),has:(t,n)=>!!Ie(t,n)||e.has(t,n)}));const Lt=["continue","continuePrimaryKey","advance"],Ce={},ce=new WeakMap,je=new WeakMap,zt={get(e,t){if(!Lt.includes(t))return e[t];let n=Ce[t];return n||(n=Ce[t]=function(...a){ce.set(this,je.get(this)[t](...a))}),n}};async function*jt(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,zt);for(je.set(n,t),U.set(n,oe(t));t;)yield n,t=await(ce.get(n)||t.continue()),ce.delete(n)}function ke(e,t){return t===Symbol.asyncIterator&&re(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&re(e,[IDBIndex,IDBObjectStore])}ze(e=>({...e,get(t,n,a){return ke(t,n)?jt:e.get(t,n,a)},has(t,n){return ke(t,n)||e.has(t,n)}}));var H=(e=>(e.Accounts="accounts",e.Records="records",e.RecordCategories="recordCategories",e))(H||{}),_={},K={};Object.defineProperty(K,"__esModule",{value:!0});K.nameof=void 0;function p(e){return e.replace(/[?!]/g,"")}function Et(e,t){var n=e.toString();if(n.startsWith("class ")&&!n.startsWith("class =>"))return p(n.substring(6,n.indexOf(" {")));if(n.includes("=>"))return p(n.substring(n.indexOf(".")+1));var a=/function\s*\(\w+\)\s*\{[\r\n\s]*return\s+\w+\.((\w+\.)*(\w+))/i,s=n.match(a);if(s)return t&&t.lastProp?s[3]:s[1];if(n.startsWith("function "))return p(n.substring(9,n.indexOf("(")));throw new Error("ts-simple-nameof: Invalid function.")}K.nameof=Et;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.nameof=void 0;var t=K;Object.defineProperty(e,"nameof",{enumerable:!0,get:function(){return t.nameof}})})(_);class $t{constructor(t,n,a,s,i){f(this,"id");f(this,"name");f(this,"type");f(this,"balance");f(this,"currency");f(this,"memo");this.name=t,this.type=n,this.balance=a,this.currency=s,this.memo=i}}var le=(e=>(e.General="一般",e))(le||{}),ue=(e=>(e.NTD="NTD",e.BTC="BTC",e.JPY="JPY",e))(ue||{});function Wt(e,t){Ft(e),Ut(e),Ht(e)}function Ft(e){const t=e.createObjectStore(H.Accounts,{keyPath:_.nameof(n=>n.id),autoIncrement:!0});t.add({name:"現金",type:le.General,balance:56e4,currency:ue.NTD,memo:"測試"}),t.add({name:"銀行",type:le.General,balance:7600,currency:ue.NTD,memo:"銀行代碼 306"})}function Ut(e){const t=e.createObjectStore(H.Records,{keyPath:_.nameof(a=>a.id),autoIncrement:!0}),n=_.nameof(a=>a.dateTime);t.createIndex(n,n,{unique:!1})}function Ht(e){const t=e.createObjectStore(H.RecordCategories,{keyPath:_.nameof(a=>a.id),autoIncrement:!0});t.add({name:"飲食",recordType:N.Spend}),t.add({name:"生活",recordType:N.Spend}),t.add({name:"薪資",recordType:N.Income}),t.add({name:"投資",recordType:N.Income});const n=_.nameof(a=>a.recordType);t.createIndex(n,n,{unique:!1})}const Kt="PWAccountingV1",qt=1;let ee=null;async function Zt(){return ee||(ee=Nt(Kt,qt,{upgrade(e,t,n,a){const s=[Wt];for(let i=t;i<(n??t+1);i++)s[i](e,a)},blocked(e,t,n){console.warn("資料庫升級被阻擋",{currentVersion:e,blockedVersion:t})},blocking(e,t,n){console.warn("等待其他標籤頁釋放資料庫",{currentVersion:e,blockedVersion:t})},terminated(){console.warn("資料庫連線終止")}})),ee}export{$t as A,ue as C,N as R,H as S,Le as V,Yt as a,Pt as b,E as c,wt as d,le as e,be as f,Zt as g,Kt as h};
