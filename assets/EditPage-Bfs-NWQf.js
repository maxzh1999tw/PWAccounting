import{S as s}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{p as V,al as h,ar as l,ao as I,a4 as _,r as R,o as N,f as k,w as e,b as t,u as r,a as A,V as c,bc as T,d as y,aq as g}from"./index-CdBy1DAC.js";import{_ as E}from"./recordCategoryEditForm.vuevuetypescriptsetuptruelang-BMuGsdie.js";import{f as S}from"./injection-BTu2Ks4h.js";import{a as u,V as w}from"./VRow-CPz841Jz.js";import{a as D,b as $}from"./dbContext-BF5vDBMi.js";import"./VSelect-D4EjrY1s.js";import"./VSlideGroup-Bj1dRMNG.js";const q={class:"w-100 text-end"},O=V({__name:"EditPage",async setup(P){let i,f;const d=S(),v=h(),m=Number(v.params.id);if(isNaN(m))throw s.fire({text:"無效的記帳類別ID",icon:"error"}).then(()=>{l.push("/recordcategory")}),new Error("Invalid record category ID");const p=([i,f]=I(()=>d.getByIdAsync(m)),i=await i,f(),i);p||s.fire({text:"找不到記帳類別",icon:"error"}).then(()=>{l.push("/recordcategory")});var n=_(p),o=_(!1);async function C(){o.value=!0,await d.updateAsync(g(n.value)),o.value=!1,await s.fire({text:"儲存成功",icon:"success"}),l.push("/recordcategory")}async function b(){var a;!((a=n.value)!=null&&a.id)||!(await s.fire({title:"你確定要刪除此記帳類別嗎？",text:"關於此記帳類別的紀錄會顯示為未知記帳類別",icon:"warning",showCancelButton:!0,confirmButtonText:"刪除",cancelButtonText:"取消"})).isConfirmed||(o.value=!0,await d.deleteAsync(g(n.value.id)),await s.fire({text:"刪除成功",icon:"success"}),l.push("/recordcategory"))}return(x,a)=>{const B=R("router-link");return N(),k(w,null,{default:e(()=>[t(u,{cols:"12",md:"12"},{default:e(()=>[t(D,{elevation:"10",loading:r(o)},{default:e(()=>[t($,null,{default:e(()=>[A("div",q,[t(c,{color:"primary",variant:"outlined",onClick:a[0]||(a[0]=j=>b()),disabled:r(o)},{default:e(()=>[t(r(T))]),_:1},8,["disabled"])]),t(E,{model:r(n),onSubmit:C,isEdit:!0},{toolBarBottom:e(()=>[t(w,{class:"mt-5"},{default:e(()=>[t(u,{cols:"6",md:"6"},{default:e(()=>[t(B,{to:"/recordcategory"},{default:e(()=>[t(c,{variant:"tonal",color:"primary",disabled:r(o),class:"w-100"},{default:e(()=>a[1]||(a[1]=[y("取消")])),_:1},8,["disabled"])]),_:1})]),_:1}),t(u,{cols:"6",md:"6"},{default:e(()=>[t(c,{color:"primary",type:"submit",disabled:r(o),class:"w-100",loading:r(o)},{default:e(()=>a[2]||(a[2]=[y("儲存")])),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})}}});export{O as default};
