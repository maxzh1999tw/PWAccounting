import{S as r}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{p as V,al as h,ar as l,ao as I,a4 as _,r as A,o as N,f as k,w as t,b as a,u as s,a as R,V as c,bc as T,d as w,aq as v}from"./index-CdBy1DAC.js";import{_ as S}from"./accountEditForm.vuevuetypescriptsetuptruelang-8-ksw98T.js";import{g as D}from"./injection-BTu2Ks4h.js";import{a as d,V as y}from"./VRow-CPz841Jz.js";import{a as E,b as $}from"./dbContext-BF5vDBMi.js";import"./VSelect-D4EjrY1s.js";import"./VSlideGroup-Bj1dRMNG.js";const q={class:"w-100 text-end"},O=V({__name:"EditPage",async setup(P){let n,m;const u=D(),b=h(),f=Number(b.params.id);if(isNaN(f))throw r.fire({text:"無效的帳戶ID",icon:"error"}).then(()=>{l.push("/account")}),new Error("Invalid account ID");const p=([n,m]=I(()=>u.getByIdAsync(f)),n=await n,m(),n);p||r.fire({text:"找不到帳戶",icon:"error"}).then(()=>{l.push("/account")});var i=_(p),o=_(!1);async function x(){o.value=!0,await u.updateAsync(v(i.value)),o.value=!1,await r.fire({text:"儲存成功",icon:"success"}),l.push("/account")}async function g(){var e;!((e=i.value)!=null&&e.id)||!(await r.fire({title:"你確定要刪除此帳號嗎？",text:"關於此帳號的紀錄會顯示為未知帳號",icon:"warning",showCancelButton:!0,confirmButtonText:"刪除",cancelButtonText:"取消"})).isConfirmed||(o.value=!0,await u.deleteAsync(v(i.value.id)),await r.fire({text:"刪除成功",icon:"success"}),l.push("/account"))}return(B,e)=>{const C=A("router-link");return N(),k(y,null,{default:t(()=>[a(d,{cols:"12",md:"12"},{default:t(()=>[a(E,{elevation:"10",loading:s(o)},{default:t(()=>[a($,null,{default:t(()=>[R("div",q,[a(c,{color:"primary",variant:"outlined",onClick:e[0]||(e[0]=j=>g()),disabled:s(o)},{default:t(()=>[a(s(T))]),_:1},8,["disabled"])]),a(S,{model:s(i),onSubmit:x},{toolBarBottom:t(()=>[a(y,{class:"mt-5"},{default:t(()=>[a(d,{cols:"6",md:"6"},{default:t(()=>[a(C,{to:"/account"},{default:t(()=>[a(c,{variant:"tonal",color:"primary",disabled:s(o),class:"w-100"},{default:t(()=>e[1]||(e[1]=[w("取消")])),_:1},8,["disabled"])]),_:1})]),_:1}),a(d,{cols:"6",md:"6"},{default:t(()=>[a(c,{color:"primary",type:"submit",disabled:s(o),class:"w-100",loading:s(o)},{default:t(()=>e[2]||(e[2]=[w("儲存")])),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})}}});export{O as default};
